{% extends "game_groups/base.html" %}

{% block title %}{{group.name}}{% endblock %}

{% block content %}
    <h1>{{group.name}}</h1>
    <p><a href="{% url 'home' %}">Home</a></p>
    <hr>
    <h3>Members:</h3>
    <p><a class="show_hide" linked-element="members" href="#">Show/Hide</a></p>
    <div class="members">
        <table class="table table-striped">
            <thead>
                <tr>
                    <th>Username</th>
                    <th>Email</th>
                    {% if group.owner == request.user %}
                        <th>Actions</th>
                    {% endif %}
                </tr>
            </thead>
            <tbody>
                {% for user in group.members.all %}
                    <tr>
                        <td><a href="{% url 'profile' username=user.username %}">{{user.username}}</a></td>
                        <td>{{user.email}}</td>
                        {% if group.owner == request.user %}
                            <td><a href="{% url 'remove_from_group' id=group.id username=user.username %}">Remove</a></td>
                        {% endif %}
                    </tr>
                {% endfor %}
            </tbody>
        </table>
        {% if group.owner == request.user %}
            <form action="{% url 'add_to_group' id=group.id %}" method="POST">
                {% csrf_token %}
                <select name="username">
                    {% for user in other_users %}
                        <option value="{{user.username}}">{{user.username}}</option>
                    {% endfor %}
                </select>
                <input class="btn btn-secondary" type="submit" value="Add to group">
            </form>
        {% endif %}
    </div>
    <hr>
    <h3>Suggested Games:</h3>
    <p><a class="show_hide" linked-element="games" href="#">Show/Hide Table</a> | <a class="show_hide" linked-element="game_images" href="#">Show/Hide Images</a></p>
    <table class="table table-striped games">
        <thead>
            <tr>
                <th>Box Image</th>
                <th>Name</th>
                <th>Owned By</th>
            </tr>
        </thead>
        <tbody>
            {% for game in games %}
                <tr>
                    <td><img class="game_images" src="{{game.thumb}}"></td>
                    <td><a href="{{game.link}}" target="_blank">{{game.name}}</a></td>
                    <td>
                        {% for user in group.members.all %}
                            {% if user in game.owners %}
                                <a href="{% url 'profile' username=user.username %}">{{user.username}}</a> 
                            {% endif %}
                        {% endfor %}
                    </td>
                </tr>
            {% endfor %}
        </tbody>
    </table>
{% endblock %}